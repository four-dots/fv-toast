{"version":3,"file":"fv-toast.umd.cjs","sources":["../src/timer.js","../src/bus.js","../src/Toast.vue","../src/api.js","../src/index.js"],"sourcesContent":["export default class Timer {\n    constructor(callback, delay) {\n        this.startedAt = Date.now();\n        this.callback = callback;\n        this.delay = delay;\n\n        this.timer = setTimeout(callback, delay);\n    }\n    pause() {\n        this.stop();\n        this.delay -= Date.now() - this.startedAt;\n    }\n    resume() {\n        this.stop();\n        this.startedAt = Date.now();\n        this.timer = setTimeout(this.callback, this.delay);\n    }\n    stop() {\n        clearTimeout(this.timer);\n    }\n}\n","import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","<template>\n    <transition enter-active-class=\"fv-toast--fade-in-up\" leave-active-class=\"fv-toast--fade-out\">\n        <div\n            role=\"alert\"\n            v-show=\"visible\"\n            class=\"fv-toast__message\"\n            :class=\"[toastState, `fv-toast__message--${position}`]\"\n            @mouseover=\"toggleTimer(true)\"\n            @mouseleave=\"toggleTimer(false)\"\n            @click=\"triggerClick\"\n        >\n            <!-- <div class=\"fv-toast__icon\"></div> -->\n            <p class=\"fv-toast__text\" v-html=\"parsedMessage\"></p>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport {ref, onMounted, onBeforeUnmount} from 'vue';\nimport {marked} from 'marked';\n\nimport Timer from './timer.js';\nimport eventBus from './bus.js';\n\nexport default {\n    name: 'fv-toast',\n    props: {\n        toastId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            required: true,\n        },\n        toastState: {\n            type: String,\n            default: 'fv-toast__message--success',\n        },\n        position: {\n            type: String,\n            default: 'right',\n            validator: (value) => ['right', 'left'].includes(value),\n        },\n        duration: {\n            type: Number,\n            default: 3000,\n        },\n        dismissible: {\n            type: Boolean,\n            default: true,\n        },\n        onClose: {\n            type: Function,\n            default: () => {},\n        },\n        onClick: {\n            type: Function,\n            default: () => {},\n        },\n        pauseOnHover: {\n            type: Boolean,\n            default: true,\n        },\n    },\n    setup(props) {\n        const visible = ref(false);\n        const parsedMessage = props.message && marked(props.message);\n\n        let timer = null;\n\n        const close = () => {\n            timer.stop();\n            visible.value = false;\n            props.onClose.apply(null, arguments);\n            setTimeout(() => eventBus.emit('toast.delete', props.toastId), 150);\n        };\n\n        const open = () => {\n            visible.value = true;\n            timer = new Timer(close, props.duration);\n        };\n\n        const triggerClick = () => {\n            if (!props.dismissible) return;\n            props.onClick.apply(null, arguments);\n            close();\n        };\n\n        const toggleTimer = (pause) => {\n            if (!props.pauseOnHover) return;\n            pause ? timer.pause() : timer.resume();\n        };\n\n        eventBus.on('toast.clear', close);\n\n        onMounted(open);\n        onBeforeUnmount(() => eventBus.off('toast.clear', close));\n\n        return {visible, parsedMessage, triggerClick, toggleTimer};\n    },\n};\n</script>\n","import Toast from './Toast.vue';\nimport eventBus from './bus.js';\nimport {createApp} from 'vue';\nimport {nanoid} from 'nanoid';\n\nconst TOASTS = new Map();\n\nconst deleteToast = (toastId) => {\n    const currentToast = TOASTS.get(toastId);\n    if (!currentToast) return;\n\n    currentToast.unmount();\n    TOASTS.delete(toastId);\n\n    document.querySelector(`[data-toast-id=\"${toastId}\"]`)?.remove();\n};\n\nexport default (app, globalOptions = {toastState: 'fv-toast__message--success'}) => {\n    eventBus.on('toast.delete', deleteToast);\n\n    return {\n        open(options) {\n            const toastId = nanoid();\n            const message = typeof options === 'string' ? options : null;\n            options = typeof options === 'string' ? {} : options;\n\n            const propsData = {message, toastId, ...globalOptions, ...options};\n\n            const toastHolder = document.createElement('div');\n            toastHolder.setAttribute('data-toast-id', toastId);\n            toastHolder.classList.add('fv-toast');\n\n            const instance = createApp(Toast, propsData);\n            instance.mount(toastHolder);\n\n            document.getElementById('fv-toasts').appendChild(toastHolder);\n\n            TOASTS.set(toastId, instance);\n        },\n        clear() {\n            eventBus.emit('toast.clear');\n        },\n        error(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--danger', ...options});\n        },\n        info(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--info', ...options});\n        },\n        warning(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--warning', ...options});\n        },\n    };\n};\n","import api from './api.js';\nimport './assets/style.scss';\n\nexport default (app, options = {}) => {\n    const holder = document.createElement('div');\n    holder.id = 'fv-toasts';\n    holder.className = 'fv-toasts';\n\n    document.body.appendChild(holder);\n\n    app.config.globalProperties.$toast = api(app, options);\n    app.provide('toast', app.config.globalProperties.$toast);\n};\n"],"names":["Timer","callback","delay","emitter","mitt","_sfc_main","value","props","visible","ref","parsedMessage","marked","timer","close","eventBus","open","triggerClick","toggleTimer","pause","onMounted","onBeforeUnmount","_hoisted_1","_createBlock","_Transition","_withCtx","_createElementVNode","_normalizeClass","$props","$setup","args","TOASTS","deleteToast","toastId","currentToast","_a","api","app","globalOptions","options","nanoid","message","propsData","toastHolder","instance","createApp","Toast","holder"],"mappings":"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"}