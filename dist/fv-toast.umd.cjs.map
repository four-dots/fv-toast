{"version":3,"file":"fv-toast.umd.cjs","sources":["../src/timer.js","../src/bus.js","../src/Toast.vue","../src/api.js","../src/index.js"],"sourcesContent":["export default class Timer {\n    constructor(callback, delay) {\n        this.startedAt = Date.now();\n        this.callback = callback;\n        this.delay = delay;\n\n        this.timer = setTimeout(callback, delay);\n    }\n    pause() {\n        this.stop();\n        this.delay -= Date.now() - this.startedAt;\n    }\n    resume() {\n        this.stop();\n        this.startedAt = Date.now();\n        this.timer = setTimeout(this.callback, this.delay);\n    }\n    stop() {\n        clearTimeout(this.timer);\n    }\n}\n","import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","<template>\n    <transition enter-active-class=\"fv-toast--fade-in-up\" leave-active-class=\"fv-toast--fade-out\">\n        <div\n            role=\"alert\"\n            v-show=\"visible\"\n            class=\"fv-toast__message\"\n            :class=\"[toastState, `fv-toast__message--${position}`]\"\n            @mouseover=\"toggleTimer(true)\"\n            @mouseleave=\"toggleTimer(false)\"\n            @click=\"triggerClick\"\n        >\n            <!-- <div class=\"fv-toast__icon\"></div> -->\n            <p class=\"fv-toast__text\" v-html=\"parsedMessage\"></p>\n        </div>\n    </transition>\n</template>\n\n<script setup>\nimport {ref, onMounted, onBeforeUnmount} from 'vue';\nimport {marked} from 'marked';\n\nimport Timer from './timer.js';\nimport eventBus from './bus.js';\n\nconst props = defineProps({\n    toastId: {\n        type: String,\n        required: true,\n    },\n    message: {\n        type: String,\n        required: true,\n    },\n    toastState: {\n        type: String,\n        default: 'fv-toast__message--success',\n    },\n    position: {\n        type: String,\n        default: 'right',\n        validator: (value) => ['right', 'left'].includes(value),\n    },\n    duration: {\n        type: Number,\n        default: 3000,\n    },\n    dismissible: {\n        type: Boolean,\n        default: true,\n    },\n    onClose: {\n        type: Function,\n        default: () => {},\n    },\n    onClick: {\n        type: Function,\n        default: () => {},\n    },\n    pauseOnHover: {\n        type: Boolean,\n        default: true,\n    },\n});\n\nconst visible = ref(false);\nconst parsedMessage = props.message && marked(props.message);\n\nlet timer = null;\n\nconst close = () => {\n    timer?.stop();\n    visible.value = false;\n    props.onClose.apply(null, arguments);\n    setTimeout(() => eventBus.emit('toast.delete', props.toastId), 150);\n};\n\nconst open = () => {\n    visible.value = true;\n    timer = new Timer(close, props.duration);\n};\n\nconst triggerClick = () => {\n    if (!props.dismissible) return;\n    props.onClick.apply(null, arguments);\n    close();\n};\n\nconst toggleTimer = (pause) => {\n    if (!props.pauseOnHover || timer === null) return;\n    pause ? timer.pause() : timer.resume();\n};\n\neventBus.on('toast.clear', close);\n\nonMounted(open);\nonBeforeUnmount(() => eventBus.off('toast.clear', close));\n</script>\n","import Toast from './Toast.vue';\nimport eventBus from './bus.js';\nimport {createApp} from 'vue';\nimport {nanoid} from 'nanoid';\n\nconst TOASTS = new Map();\n\nconst deleteToast = (toastId) => {\n    const currentToast = TOASTS.get(toastId);\n    if (!currentToast) return;\n\n    currentToast.unmount();\n    TOASTS.delete(toastId);\n\n    document.querySelector(`[data-toast-id=\"${toastId}\"]`)?.remove();\n};\n\nexport default (app, globalOptions = {toastState: 'fv-toast__message--success'}) => {\n    eventBus.on('toast.delete', deleteToast);\n\n    return {\n        open(options) {\n            const toastId = nanoid();\n            const message = typeof options === 'string' ? options : null;\n            options = typeof options === 'string' ? {} : options;\n\n            const propsData = {message, toastId, ...globalOptions, ...options};\n\n            const toastHolder = document.createElement('div');\n            toastHolder.setAttribute('data-toast-id', toastId);\n            toastHolder.classList.add('fv-toast');\n\n            const instance = createApp(Toast, propsData);\n            instance.mount(toastHolder);\n\n            document.getElementById('fv-toasts').appendChild(toastHolder);\n\n            TOASTS.set(toastId, instance);\n        },\n        clear() {\n            eventBus.emit('toast.clear');\n        },\n        error(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--danger', ...options});\n        },\n        info(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--info', ...options});\n        },\n        warning(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--warning', ...options});\n        },\n    };\n};\n","import api from './api.js';\nimport './assets/style.scss';\n\nexport default (app, options = {}) => {\n    const holder = document.createElement('div');\n    holder.id = 'fv-toasts';\n    holder.className = 'fv-toasts';\n\n    document.body.appendChild(holder);\n\n    app.config.globalProperties.$toast = api(app, options);\n    app.provide('toast', app.config.globalProperties.$toast);\n};\n"],"names":["Timer","callback","delay","emitter","mitt","props","__props","visible","ref","parsedMessage","marked","timer","close","eventBus","open","triggerClick","toggleTimer","pause","onMounted","onBeforeUnmount","_createBlock","_Transition","_createElementVNode","_normalizeClass","_unref","TOASTS","deleteToast","toastId","currentToast","api","app","globalOptions","options","nanoid","message","propsData","toastHolder","instance","createApp","Toast","holder"],"mappings":"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"}