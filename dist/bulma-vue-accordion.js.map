{"version":3,"file":"bulma-vue-accordion.js","sources":["../src/bus.js","../src/Accordions.vue","../src/options.js","../src/Accordion.vue","../src/index.js"],"sourcesContent":["import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","<template>\n    <section class=\"bv-accordions\"><slot></slot></section>\n</template>\n\n<script>\nimport {onBeforeUnmount, onMounted, provide} from 'vue';\n\nimport eventBus from './bus.js';\n\nexport default {\n    name: 'bv-accordions',\n    props: {\n        single: {\n            default: true,\n            type: Boolean,\n        },\n    },\n    setup(props, {slots}) {\n        const children = [];\n        const registeredAccordions = slots.default()[0].children.length;\n\n        const dispatchCloseEvent = (accordionId) => {\n            let accordionsToClose = children.reduce((carry, child) => {\n                if (child.id === accordionId) return carry;\n                child.state = false;\n                return [child.id, ...carry];\n            }, []);\n\n            eventBus.emit('accordion.close', accordionsToClose);\n        };\n\n        const closeAccordions = ({accordionId, state}) => {\n            if (!props.single || !state) return;\n            if (!children.find((child) => child.id === accordionId)) return;\n\n            dispatchCloseEvent(accordionId);\n        };\n\n        const closeOtherAccordions = () => {\n            if (!props.single) return;\n            let openAccordion = null;\n\n            for (const child of children) {\n                openAccordion ||= child.state ? child.id : null;\n                if (openAccordion) break;\n            }\n\n            if (!openAccordion) return;\n            dispatchCloseEvent(openAccordion);\n        };\n\n        const registerChild = (child) => {\n            children.push(child);\n            if (children.length !== registeredAccordions) return;\n            closeOtherAccordions();\n        };\n\n        provide('registerChild', registerChild);\n\n        onMounted(() => eventBus.on('accordion.toggle', closeAccordions));\n        onBeforeUnmount(() => eventBus.off('accordion.toggle'));\n    },\n};\n</script>\n","export default {\n    data: {\n        baseIconClass: 'fas',\n        openClass: 'fa-minus',\n        closedClass: 'fa-plus',\n        openComponent: null,\n        closedComponent: null,\n    },\n\n    getOptions() {\n        return this.data;\n    },\n    setOptions(options) {\n        for (const key in options) {\n            if (Object.hasOwn(this.data, key)) {\n                this.data[key] = options[key];\n            }\n        }\n    },\n    setOption(key, value) {\n        if (!Object.hasOwn(this.data, key)) return;\n        this.data[key] = value;\n    },\n};\n","<template>\n    <section\n        class=\"bv-accordion\"\n        :data-accordion-id=\"accordionId\"\n        :class=\"{'bv-accordion--without-toggle': !togglable, 'is-open': state}\"\n    >\n        <header class=\"bv-accordion__header\">\n            <div v-if=\"togglable\" class=\"bv-accordion__toggle\" @click=\"toggle\">\n                <template v-if=\"state\">\n                    <span v-if=\"options.baseIconClass\" class=\"icon\"\n                        ><i :class=\"[options.baseIconClass, options.openClass]\"></i\n                    ></span>\n                    <component v-if=\"options.openComponent\" :is=\"options.openComponent\"></component>\n                </template>\n                <template v-else>\n                    <span v-if=\"options.baseIconClass\" class=\"icon\"\n                        ><i :class=\"[options.baseIconClass, options.closedClass]\"></i\n                    ></span>\n                    <component v-if=\"options.closedComponent\" :is=\"options.closedComponent\"></component>\n                </template>\n            </div>\n            <div class=\"bv-accordion__title\" @click=\"toggle\"><slot name=\"title\"></slot></div>\n            <div class=\"bv-accordion__actions\"><slot name=\"actions\"></slot></div>\n        </header>\n        <transition name=\"bv-accordion-toggle\" @enter=\"enter\" @after-enter=\"afterEnter\" @leave=\"leave\">\n            <article v-show=\"state\" class=\"bv-accordion__content content\">\n                <slot name=\"content\" v-bind:state=\"state\"></slot>\n            </article>\n        </transition>\n    </section>\n</template>\n\n<script>\nimport {ref, nextTick, onBeforeUnmount, watch, inject} from 'vue';\nimport {nanoid} from 'nanoid';\n\nimport eventBus from './bus.js';\nimport optionsStore from './options.js';\n\nexport default {\n    name: 'bv-accordion',\n    props: {\n        togglable: {\n            type: Boolean,\n            default: true,\n        },\n        open: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: ['toggle'],\n    setup(props, {emit}) {\n        const state = ref(props.open);\n        const accordionId = nanoid();\n        const registerChild = inject('registerChild', null);\n\n        const toggle = async () => {\n            if (!props.togglable) return;\n            await nextTick();\n\n            state.value = !state.value;\n            emit('toggle', state.value);\n            eventBus.emit('accordion.toggle', {accordionId, state: state.value});\n        };\n\n        const trigger = async (newState) => {\n            await nextTick();\n\n            state.value = newState;\n            emit('toggle', state.value);\n            eventBus.emit('accordion.toggle', {accordionId, state: state.value});\n        };\n\n        const enter = async (element) => {\n            const width = getComputedStyle(element).width;\n\n            element.style.width = width;\n            element.style.position = 'absolute';\n            element.style.visibility = 'hidden';\n            element.style.height = 'auto';\n\n            const height = getComputedStyle(element).height;\n\n            element.style.width = null;\n            element.style.position = null;\n            element.style.visibility = null;\n            element.style.height = 0;\n\n            getComputedStyle(element).height;\n            await nextTick();\n            element.style.height = height;\n        };\n\n        const afterEnter = (element) => {\n            element.style.height = 'auto';\n        };\n\n        const leave = async (element) => {\n            const height = getComputedStyle(element).height;\n            element.style.height = height;\n\n            getComputedStyle(element).height;\n            await nextTick();\n            element.style.height = 0;\n        };\n\n        const close = (accordionsToClose) => {\n            if (!state.value || !props.togglable || !accordionsToClose.includes(accordionId)) return;\n            state.value = false;\n        };\n\n        eventBus.on('accordion.close', close);\n\n        if (registerChild) {\n            registerChild({id: accordionId, state: state.value});\n        }\n\n        onBeforeUnmount(() => eventBus.off('accordion.close'));\n\n        watch(\n            () => props.open,\n            (value) => {\n                if (value === state.value) return;\n                toggle();\n            }\n        );\n\n        const options = optionsStore.getOptions();\n\n        return {accordionId, state, toggle, trigger, enter, afterEnter, leave, options};\n    },\n};\n</script>\n","import Accordions from './Accordions.vue';\nimport Accordion from './Accordion.vue';\nimport './assets/style.scss';\n\nimport optionsStore from './options.js';\n\nexport default (app, options) => {\n    optionsStore.setOptions(options);\n\n    app.component('Accordion', Accordion);\n    app.component('Accordions', Accordions);\n};\n"],"names":["emitter","mitt","_sfc_main","props","slots","children","registeredAccordions","dispatchCloseEvent","accordionId","accordionsToClose","carry","child","eventBus","closeAccordions","state","closeOtherAccordions","openAccordion","provide","onMounted","onBeforeUnmount","_hoisted_1","_openBlock","_createElementBlock","_renderSlot","_ctx","optionsStore","options","key","value","emit","ref","nanoid","registerChild","inject","toggle","nextTick","trigger","newState","enter","element","width","height","afterEnter","leave","close","watch","_hoisted_2","_hoisted_5","_hoisted_6","_normalizeClass","$props","$setup","_createElementVNode","args","_Fragment","_hoisted_3","_createBlock","_resolveDynamicComponent","_hoisted_4","_createVNode","_Transition","_withDirectives","index","app","Accordion","Accordions"],"mappings":"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"}