{"version":3,"file":"bulma-vue-accordion.es.js","sources":["../src/bus.js","../plugin-vue:export-helper","../src/Accordions.vue","../src/Accordion.vue","../src/index.js"],"sourcesContent":["import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","<template>\n    <section class=\"bv-accordions\"><slot></slot></section>\n</template>\n\n<script>\nimport {onBeforeUnmount, onMounted, provide} from 'vue';\n\nimport eventBus from './bus.js';\n\nexport default {\n    name: 'bv-accordions',\n    props: {\n        single: {\n            default: true,\n            type: Boolean,\n        },\n    },\n    setup(props, {slots}) {\n        const children = [];\n        const registeredAccordions = slots.default()[0].children.length;\n\n        const dispatchCloseEvent = (accordionId) => {\n            let accordionsToClose = children.reduce((carry, child) => {\n                if (child.id === accordionId) return carry;\n                child.state = false;\n                return [child.id, ...carry];\n            }, []);\n\n            eventBus.emit('accordion.close', accordionsToClose);\n        };\n\n        const closeAccordions = ({accordionId, state}) => {\n            if (!props.single || !state) return;\n            if (!children.find((child) => child.id === accordionId)) return;\n\n            dispatchCloseEvent(accordionId);\n        };\n\n        const closeOtherAccordions = () => {\n            if (!props.single) return;\n            let openAccordion = null;\n\n            for (const child of children) {\n                openAccordion ||= child.state ? child.id : null;\n                if (openAccordion) break;\n            }\n\n            if (!openAccordion) return;\n            dispatchCloseEvent(openAccordion);\n        };\n\n        const registerChild = (child) => {\n            children.push(child);\n            if (children.length !== registeredAccordions) return;\n            closeOtherAccordions();\n        };\n\n        provide('registerChild', registerChild);\n\n        onMounted(() => {\n            eventBus.on('accordion.toggle', closeAccordions);\n        });\n\n        onBeforeUnmount(() => {\n            eventBus.off('accordion.toggle');\n        });\n    },\n};\n</script>\n","<template>\n    <section\n        class=\"bv-accordion\"\n        :data-accordion-id=\"accordionId\"\n        :class=\"{'bv-accordion--without-toggle': !togglable, 'is-open': state}\"\n    >\n        <header class=\"bv-accordion__header\">\n            <div v-if=\"togglable\" class=\"bv-accordion__toggle\" @click=\"toggle\">\n                <template v-if=\"usesFontAwesome\">\n                    <span class=\"icon\"><i class=\"fas fal\" :class=\"[state ? 'fa-minus' : 'fa-plus']\"></i></span>\n                </template>\n                <template v-else>{{ state ? '-' : '+' }}</template>\n            </div>\n            <div class=\"bv-accordion__title\" @click=\"toggle\"><slot name=\"title\"></slot></div>\n            <div class=\"bv-accordion__actions\"><slot name=\"actions\"></slot></div>\n        </header>\n        <transition name=\"bv-accordion-toggle\" @enter=\"enter\" @after-enter=\"afterEnter\" @leave=\"leave\">\n            <article v-show=\"state\" class=\"bv-accordion__content content\">\n                <slot name=\"content\" v-bind:state=\"state\"></slot>\n            </article>\n        </transition>\n    </section>\n</template>\n\n<script>\nimport {ref, nextTick, onBeforeUnmount, watch, inject} from 'vue';\nimport {nanoid} from 'nanoid';\n\nimport eventBus from './bus.js';\n\nexport default {\n    name: 'bv-accordion',\n    props: {\n        usesFontAwesome: {\n            type: Boolean,\n            default: true,\n        },\n        togglable: {\n            type: Boolean,\n            default: true,\n        },\n        open: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: ['toggle'],\n    setup(props, {emit}) {\n        const state = ref(props.open);\n        const accordionId = nanoid();\n        const registerChild = inject('registerChild', null);\n\n        const toggle = async () => {\n            if (!props.togglable) return;\n            await nextTick();\n\n            state.value = !state.value;\n            emit('toggle', state.value);\n            eventBus.emit('accordion.toggle', {accordionId, state: state.value});\n        };\n\n        const trigger = async (newState) => {\n            await nextTick();\n\n            state.value = newState;\n            emit('toggle', state.value);\n            eventBus.emit('accordion.toggle', {accordionId, state: state.value});\n        };\n\n        const enter = async (element) => {\n            const width = getComputedStyle(element).width;\n\n            element.style.width = width;\n            element.style.position = 'absolute';\n            element.style.visibility = 'hidden';\n            element.style.height = 'auto';\n\n            const height = getComputedStyle(element).height;\n\n            element.style.width = null;\n            element.style.position = null;\n            element.style.visibility = null;\n            element.style.height = 0;\n\n            getComputedStyle(element).height;\n            await nextTick();\n            element.style.height = height;\n        };\n\n        const afterEnter = (element) => {\n            element.style.height = 'auto';\n        };\n\n        const leave = async (element) => {\n            const height = getComputedStyle(element).height;\n            element.style.height = height;\n\n            getComputedStyle(element).height;\n            await nextTick();\n            element.style.height = 0;\n        };\n\n        const close = (accordionsToClose) => {\n            if (!state.value || !props.togglable || !accordionsToClose.includes(accordionId)) return;\n            state.value = false;\n        };\n\n        eventBus.on('accordion.close', close);\n\n        if (registerChild) {\n            registerChild({id: accordionId, state: state.value});\n        }\n\n        onBeforeUnmount(() => eventBus.off('accordion.close'));\n\n        watch(\n            () => props.open,\n            (value) => {\n                if (value === state.value) return;\n                toggle();\n            }\n        );\n\n        return {accordionId, state, toggle, trigger, enter, afterEnter, leave};\n    },\n};\n</script>\n","import Accordions from './Accordions.vue';\nimport Accordion from './Accordion.vue';\nimport './assets/style.scss';\n\nexport default (app) => {\n    app.component('Accordion', Accordion);\n    app.component('Accordions', Accordions);\n};\n"],"names":["_sfc_main","eventBus","_openBlock","_createElementBlock","_hoisted_1","_normalizeClass","_createCommentVNode","_createElementVNode","_createVNode","_Transition","_withCtx"],"mappings":"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"}