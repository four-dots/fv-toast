{"version":3,"file":"fv-toast.js","sources":["../src/timer.js","../src/bus.js","../src/Toast.vue","../src/api.js","../src/index.js"],"sourcesContent":["export default class Timer {\n    constructor(callback, delay) {\n        this.startedAt = Date.now();\n        this.callback = callback;\n        this.delay = delay;\n\n        this.timer = setTimeout(callback, delay);\n    }\n    pause() {\n        this.stop();\n        this.delay -= Date.now() - this.startedAt;\n    }\n    resume() {\n        this.stop();\n        this.startedAt = Date.now();\n        this.timer = setTimeout(this.callback, this.delay);\n    }\n    stop() {\n        clearTimeout(this.timer);\n    }\n}\n","import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","<template>\n    <transition enter-active-class=\"fv-toast--fade-in-up\" leave-active-class=\"fv-toast--fade-out\">\n        <div\n            role=\"alert\"\n            v-show=\"visible\"\n            class=\"fv-toast__message\"\n            :class=\"[toastState, `fv-toast__message--${position}`]\"\n            @mouseover=\"toggleTimer(true)\"\n            @mouseleave=\"toggleTimer(false)\"\n            @click=\"triggerClick\"\n        >\n            <!-- <div class=\"fv-toast__icon\"></div> -->\n            <p class=\"fv-toast__text\" v-html=\"parsedMessage\"></p>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport {ref, onMounted, onBeforeUnmount} from 'vue';\nimport {marked} from 'marked';\n\nimport Timer from './timer.js';\nimport eventBus from './bus.js';\n\nexport default {\n    name: 'fv-toast',\n    props: {\n        toastId: {\n            type: String,\n            required: true,\n        },\n        message: {\n            type: String,\n            required: true,\n        },\n        toastState: {\n            type: String,\n            default: 'fv-toast__message--success',\n        },\n        position: {\n            type: String,\n            default: 'right',\n            validator: (value) => ['right', 'left'].includes(value),\n        },\n        duration: {\n            type: Number,\n            default: 3000,\n        },\n        dismissible: {\n            type: Boolean,\n            default: true,\n        },\n        onClose: {\n            type: Function,\n            default: () => {},\n        },\n        onClick: {\n            type: Function,\n            default: () => {},\n        },\n        pauseOnHover: {\n            type: Boolean,\n            default: true,\n        },\n    },\n    setup(props) {\n        const visible = ref(false);\n        const parsedMessage = props.message && marked(props.message);\n\n        let timer = null;\n\n        const close = () => {\n            timer.stop();\n            visible.value = false;\n            props.onClose.apply(null, arguments);\n            setTimeout(() => eventBus.emit('toast.delete', props.toastId), 150);\n        };\n\n        const open = () => {\n            visible.value = true;\n            timer = new Timer(close, props.duration);\n        };\n\n        const triggerClick = () => {\n            if (!props.dismissible) return;\n            props.onClick.apply(null, arguments);\n            close();\n        };\n\n        const toggleTimer = (pause) => {\n            if (!props.pauseOnHover) return;\n            pause ? timer.pause() : timer.resume();\n        };\n\n        eventBus.on('toast.clear', close);\n\n        onMounted(open);\n        onBeforeUnmount(() => eventBus.off('toast.clear', close));\n\n        return {visible, parsedMessage, triggerClick, toggleTimer};\n    },\n};\n</script>\n","import Toast from './Toast.vue';\nimport eventBus from './bus.js';\nimport {createApp} from 'vue';\nimport {nanoid} from 'nanoid';\n\nconst TOASTS = new Map();\n\nconst deleteToast = (toastId) => {\n    const currentToast = TOASTS.get(toastId);\n    if (!currentToast) return;\n\n    currentToast.unmount();\n    TOASTS.delete(toastId);\n\n    document.querySelector(`[data-toast-id=\"${toastId}\"]`)?.remove();\n};\n\nexport default (app, globalOptions = {toastState: 'fv-toast__message--success'}) => {\n    eventBus.on('toast.delete', deleteToast);\n\n    return {\n        open(options) {\n            const toastId = nanoid();\n            const message = typeof options === 'string' ? options : null;\n            options = typeof options === 'string' ? {} : options;\n\n            const propsData = {message, toastId, ...globalOptions, ...options};\n\n            const toastHolder = document.createElement('div');\n            toastHolder.setAttribute('data-toast-id', toastId);\n            toastHolder.classList.add('fv-toast');\n\n            const instance = createApp(Toast, propsData);\n            instance.mount(toastHolder);\n\n            document.getElementById('fv-toasts').appendChild(toastHolder);\n\n            TOASTS.set(toastId, instance);\n        },\n        clear() {\n            eventBus.emit('toast.clear');\n        },\n        error(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--danger', ...options});\n        },\n        info(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--info', ...options});\n        },\n        warning(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--warning', ...options});\n        },\n    };\n};\n","import api from './api.js';\nimport './assets/style.scss';\n\nexport default (app, options = {}) => {\n    const holder = document.createElement('div');\n    holder.id = 'fv-toasts';\n    holder.className = 'fv-toasts';\n\n    document.body.appendChild(holder);\n\n    app.config.globalProperties.$toast = api(app, options);\n    app.provide('toast', app.config.globalProperties.$toast);\n};\n"],"names":["Timer","callback","delay","emitter","mitt","_sfc_main","value","props","visible","ref","parsedMessage","marked","timer","close","eventBus","open","triggerClick","toggleTimer","pause","onMounted","onBeforeUnmount","_hoisted_1","_createBlock","_Transition","_withCtx","_createElementVNode","_normalizeClass","$props","$setup","args","TOASTS","deleteToast","toastId","currentToast","_a","api","app","globalOptions","options","nanoid","message","propsData","toastHolder","instance","createApp","Toast","index","holder"],"mappings":"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"}