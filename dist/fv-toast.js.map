{"version":3,"file":"fv-toast.js","sources":["../src/timer.js","../src/bus.js","../src/Toast.vue","../src/api.js","../src/index.js"],"sourcesContent":["export default class Timer {\n    constructor(callback, delay) {\n        this.startedAt = Date.now();\n        this.callback = callback;\n        this.delay = delay;\n\n        this.timer = setTimeout(callback, delay);\n    }\n    pause() {\n        this.stop();\n        this.delay -= Date.now() - this.startedAt;\n    }\n    resume() {\n        this.stop();\n        this.startedAt = Date.now();\n        this.timer = setTimeout(this.callback, this.delay);\n    }\n    stop() {\n        clearTimeout(this.timer);\n    }\n}\n","import mitt from 'mitt';\n\nconst emitter = mitt();\nexport default emitter;\n","<template>\n    <transition enter-active-class=\"fv-toast--fade-in-up\" leave-active-class=\"fv-toast--fade-out\">\n        <div\n            role=\"alert\"\n            v-show=\"visible\"\n            class=\"fv-toast__message\"\n            :class=\"[toastState, `fv-toast__message--${position}`]\"\n            @mouseover=\"toggleTimer(true)\"\n            @mouseleave=\"toggleTimer(false)\"\n            @click=\"triggerClick\"\n        >\n            <!-- <div class=\"fv-toast__icon\"></div> -->\n            <p class=\"fv-toast__text\" v-html=\"parsedMessage\"></p>\n        </div>\n    </transition>\n</template>\n\n<script setup>\nimport {ref, onMounted, onBeforeUnmount} from 'vue';\nimport {marked} from 'marked';\n\nimport Timer from './timer.js';\nimport eventBus from './bus.js';\n\nconst props = defineProps({\n    toastId: {\n        type: String,\n        required: true,\n    },\n    message: {\n        type: String,\n        required: true,\n    },\n    toastState: {\n        type: String,\n        default: 'fv-toast__message--success',\n    },\n    position: {\n        type: String,\n        default: 'right',\n        validator: (value) => ['right', 'left'].includes(value),\n    },\n    duration: {\n        type: Number,\n        default: 3000,\n    },\n    dismissible: {\n        type: Boolean,\n        default: true,\n    },\n    onClose: {\n        type: Function,\n        default: () => {},\n    },\n    onClick: {\n        type: Function,\n        default: () => {},\n    },\n    pauseOnHover: {\n        type: Boolean,\n        default: true,\n    },\n});\n\nconst visible = ref(false);\nconst parsedMessage = props.message && marked(props.message);\n\nlet timer = null;\n\nconst close = () => {\n    timer?.stop();\n    visible.value = false;\n    props.onClose.apply(null, arguments);\n    setTimeout(() => eventBus.emit('toast.delete', props.toastId), 150);\n};\n\nconst open = () => {\n    visible.value = true;\n    timer = new Timer(close, props.duration);\n};\n\nconst triggerClick = () => {\n    if (!props.dismissible) return;\n    props.onClick.apply(null, arguments);\n    close();\n};\n\nconst toggleTimer = (pause) => {\n    if (!props.pauseOnHover || timer === null) return;\n    pause ? timer.pause() : timer.resume();\n};\n\neventBus.on('toast.clear', close);\n\nonMounted(open);\nonBeforeUnmount(() => eventBus.off('toast.clear', close));\n</script>\n","import Toast from './Toast.vue';\nimport eventBus from './bus.js';\nimport {createApp} from 'vue';\nimport {nanoid} from 'nanoid';\n\nconst TOASTS = new Map();\n\nconst deleteToast = (toastId) => {\n    const currentToast = TOASTS.get(toastId);\n    if (!currentToast) return;\n\n    currentToast.unmount();\n    TOASTS.delete(toastId);\n\n    document.querySelector(`[data-toast-id=\"${toastId}\"]`)?.remove();\n};\n\nexport default (app, globalOptions = {toastState: 'fv-toast__message--success'}) => {\n    eventBus.on('toast.delete', deleteToast);\n\n    return {\n        open(options) {\n            const toastId = nanoid();\n            const message = typeof options === 'string' ? options : null;\n            options = typeof options === 'string' ? {} : options;\n\n            const propsData = {message, toastId, ...globalOptions, ...options};\n\n            const toastHolder = document.createElement('div');\n            toastHolder.setAttribute('data-toast-id', toastId);\n            toastHolder.classList.add('fv-toast');\n\n            const instance = createApp(Toast, propsData);\n            instance.mount(toastHolder);\n\n            document.getElementById('fv-toasts').appendChild(toastHolder);\n\n            TOASTS.set(toastId, instance);\n        },\n        clear() {\n            eventBus.emit('toast.clear');\n        },\n        error(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--danger', ...options});\n        },\n        info(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--info', ...options});\n        },\n        warning(message, options = {}) {\n            return this.open({message, toastState: 'fv-toast__message--warning', ...options});\n        },\n    };\n};\n","import api from './api.js';\nimport './assets/style.scss';\n\nexport default (app, options = {}) => {\n    const holder = document.createElement('div');\n    holder.id = 'fv-toasts';\n    holder.className = 'fv-toasts';\n\n    document.body.appendChild(holder);\n\n    app.config.globalProperties.$toast = api(app, options);\n    app.provide('toast', app.config.globalProperties.$toast);\n};\n"],"names":["Timer","callback","delay","emitter","mitt","props","__props","visible","ref","parsedMessage","marked","timer","close","eventBus","open","triggerClick","toggleTimer","pause","onMounted","onBeforeUnmount","_createBlock","_Transition","_createElementVNode","_normalizeClass","_unref","TOASTS","deleteToast","toastId","currentToast","api","app","globalOptions","options","nanoid","message","propsData","toastHolder","instance","createApp","Toast","index","holder"],"mappings":";;;;AAAe,MAAMA,EAAM;AAAA,EACvB,YAAYC,GAAUC,GAAO;AACzB,SAAK,YAAY,KAAK,IAAG,GACzB,KAAK,WAAWD,GAChB,KAAK,QAAQC,GAEb,KAAK,QAAQ,WAAWD,GAAUC,CAAK;AAAA,EAC3C;AAAA,EACA,QAAQ;AACJ,SAAK,KAAI,GACT,KAAK,SAAS,KAAK,IAAG,IAAK,KAAK;AAAA,EACpC;AAAA,EACA,SAAS;AACL,SAAK,KAAI,GACT,KAAK,YAAY,KAAK,IAAG,GACzB,KAAK,QAAQ,WAAW,KAAK,UAAU,KAAK,KAAK;AAAA,EACrD;AAAA,EACA,OAAO;AACH,iBAAa,KAAK,KAAK;AAAA,EAC3B;AACJ;AClBA,MAAMC,IAAUC,EAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsBpB,UAAMC,IAAQC,GAwCRC,IAAUC,EAAI,EAAK,GACnBC,IAAgBJ,EAAM,WAAWK,EAAOL,EAAM,OAAO;AAE3D,QAAIM,IAAQ;AAEZ,UAAMC,IAAQ,MAAM;AAChB,MAAAD,GAAO,KAAI,GACXJ,EAAQ,QAAQ,IAChBF,EAAM,QAAQ,MAAM,MAAM,SAAS,GACnC,WAAW,MAAMQ,EAAS,KAAK,gBAAgBR,EAAM,OAAO,GAAG,GAAG;AAAA,IACtE,GAEMS,IAAO,MAAM;AACf,MAAAP,EAAQ,QAAQ,IAChBI,IAAQ,IAAIX,EAAMY,GAAOP,EAAM,QAAQ;AAAA,IAC3C,GAEMU,IAAe,MAAM;AACvB,MAAKV,EAAM,gBACXA,EAAM,QAAQ,MAAM,MAAM,SAAS,GACnCO,EAAK;AAAA,IACT,GAEMI,IAAc,CAACC,MAAU;AAC3B,MAAI,CAACZ,EAAM,gBAAgBM,MAAU,SACrCM,IAAQN,EAAM,UAAUA,EAAM,OAAM;AAAA,IACxC;AAEAE,WAAAA,EAAS,GAAG,eAAeD,CAAK,GAEhCM,EAAUJ,CAAI,GACdK,EAAgB,MAAMN,EAAS,IAAI,eAAeD,CAAK,CAAC,mBA9FpDQ,EAaaC,GAAA;AAAA,MAbD,sBAAmB;AAAA,MAAuB,sBAAmB;AAAA;iBACrE,MAWM;AAAA,UAXNC,EAWM,OAAA;AAAA,UAVF,MAAK;AAAA,UAEL,OAAKC,EAAA,CAAC,qBAAmB,CAChBjB,EAAA,kCAAkCA,EAAA,QAAQ,EAAA,CAAA,CAAA;AAAA,UAClD,oCAAWU,EAAW,EAAA;AAAA,UACtB,qCAAYA,EAAW,EAAA;AAAA,UACvB,SAAOD;AAAA;UAGRO,EAAqD,KAAA;AAAA,YAAlD,OAAM;AAAA,YAAiB,WAAQE,EAAAf,CAAA;AAAA;;cAR1BF,EAAA,KAAO;AAAA;;;;;GCCrBkB,IAAS,oBAAI,IAAG,GAEhBC,IAAc,CAACC,MAAY;AAC7B,QAAMC,IAAeH,EAAO,IAAIE,CAAO;AACvC,EAAKC,MAELA,EAAa,QAAO,GACpBH,EAAO,OAAOE,CAAO,GAErB,SAAS,cAAc,mBAAmBA,CAAO,IAAI,GAAG,OAAM;AAClE,GAEAE,IAAe,CAACC,GAAKC,IAAgB,EAAC,YAAY,6BAA4B,OAC1ElB,EAAS,GAAG,gBAAgBa,CAAW,GAEhC;AAAA,EACH,KAAKM,GAAS;AACV,UAAML,IAAUM,EAAM,GAChBC,IAAU,OAAOF,KAAY,WAAWA,IAAU;AACxD,IAAAA,IAAU,OAAOA,KAAY,WAAW,CAAA,IAAKA;AAE7C,UAAMG,IAAY,EAAC,SAAAD,GAAS,SAAAP,GAAS,GAAGI,GAAe,GAAGC,EAAO,GAE3DI,IAAc,SAAS,cAAc,KAAK;AAChD,IAAAA,EAAY,aAAa,iBAAiBT,CAAO,GACjDS,EAAY,UAAU,IAAI,UAAU;AAEpC,UAAMC,IAAWC,EAAUC,GAAOJ,CAAS;AAC3C,IAAAE,EAAS,MAAMD,CAAW,GAE1B,SAAS,eAAe,WAAW,EAAE,YAAYA,CAAW,GAE5DX,EAAO,IAAIE,GAASU,CAAQ;AAAA,EAChC;AAAA,EACA,QAAQ;AACJxB,IAAAA,EAAS,KAAK,aAAa;AAAA,EAC/B;AAAA,EACA,MAAMqB,GAASF,IAAU,IAAI;AACzB,WAAO,KAAK,KAAK,EAAC,SAAAE,GAAS,YAAY,6BAA6B,GAAGF,EAAO,CAAC;AAAA,EACnF;AAAA,EACA,KAAKE,GAASF,IAAU,IAAI;AACxB,WAAO,KAAK,KAAK,EAAC,SAAAE,GAAS,YAAY,2BAA2B,GAAGF,EAAO,CAAC;AAAA,EACjF;AAAA,EACA,QAAQE,GAASF,IAAU,IAAI;AAC3B,WAAO,KAAK,KAAK,EAAC,SAAAE,GAAS,YAAY,8BAA8B,GAAGF,EAAO,CAAC;AAAA,EACpF;AACR,IChDAQ,IAAe,CAACV,GAAKE,IAAU,OAAO;AAClC,QAAMS,IAAS,SAAS,cAAc,KAAK;AAC3C,EAAAA,EAAO,KAAK,aACZA,EAAO,YAAY,aAEnB,SAAS,KAAK,YAAYA,CAAM,GAEhCX,EAAI,OAAO,iBAAiB,SAASD,EAAIC,GAAKE,CAAO,GACrDF,EAAI,QAAQ,SAASA,EAAI,OAAO,iBAAiB,MAAM;AAC3D;"}